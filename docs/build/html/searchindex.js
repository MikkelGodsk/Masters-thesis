Search.setIndex({"docnames": ["index", "modules", "setup", "src", "tests"], "filenames": ["index.rst", "modules.rst", "setup.rst", "src.rst", "tests.rst"], "titles": ["Welcome to Master\u2019s thesis\u2019s documentation!", "Masters-thesis", "setup module", "src package", "tests package"], "terms": {"index": 0, "modul": [0, 1], "search": 0, "page": 0, "setup": [1, 3], "src": [0, 1], "packag": [0, 1], "submodul": 1, "backprop_trick": 1, "finetun": 1, "lima_util": 1, "profiler_callback": 1, "content": 1, "test": [0, 1, 3], "backprop_trick_test_util": 1, "test_backprop_trick": 1, "test_lima_data_formatt": 1, "motheroptim": [1, 3], "get_optimizers_and_virtual_param_group": [1, 3], "step": [1, 3], "zero_grad": [1, 3], "virtualparametergroup": [1, 3], "item": [1, 3], "join_paramet": [1, 3], "kei": [1, 3], "valu": [1, 3], "cast_parameter_iterables_to_list": [1, 3], "fusion_step_hook": [1, 3], "get_parameter_list": [1, 3], "get_experiment_nam": [1, 3], "main": [1, 3], "examplecallback": [1, 3], "template_formatt": [1, 3], "max_seq_length": [1, 3], "log_n_exampl": [1, 3], "on_log": [1, 3], "templateformatt": [1, 3], "d": [1, 3], "token": [1, 3], "instruction_templ": [1, 3], "response_templ": [1, 3], "map_kwarg": [1, 3], "data_processor": [1, 3], "train_d": [1, 3], "test_d": [1, 3], "collat": [1, 3], "process_lima": [1, 3], "get_instruction_and_respons": [1, 3], "remove_prompt_from_complet": [1, 3], "correct_tokenized_prompt": [1, 3], "correct_tokenized_instruct": [], "filter_exampl": [1, 3], "process_exampl": [1, 3], "memoryhistorycallback": [1, 3], "start": [1, 3], "stop": [1, 3], "profilercallbackbas": [1, 3], "on_epoch_begin": [1, 3], "on_epoch_end": [1, 3], "on_step_begin": [1, 3], "on_step_end": [1, 3], "on_train_end": [1, 3], "start_": [1, 3], "step_": [1, 3], "stop_": [1, 3], "torchprofilercallback": [1, 3], "setup_profil": [1, 3], "wandbprofilercallback": [1, 3], "wandbtimercallback": [1, 3], "on_train_begin": [1, 3], "extract_memory_timeline_svg": [1, 3], "get_timestamp": [1, 3], "torch_get_devic": [1, 3], "ann": [1, 4], "forward": [1, 4], "consistency_check": [1, 4], "net_eq": [1, 4], "test_backprop_trick_small_ann_no_parameter_group": [1, 4], "test_backprop_trick_small_ann_with_parameter_group": [1, 4], "test_mother_optim": [1, 4], "test_mother_optimizer_init_no_parameter_groups_given": [1, 4], "error_on_warn": [1, 4], "test_correct_tokenized_prompt": [], "test_data_formatter_all_examples_no_warn": [1, 4], "test_data_formatter_exact_match": [1, 4], "test_error_on_warn": [1, 4], "class": [1, 4], "param": 3, "iter": 3, "tensor": 3, "dict": 3, "str": 3, "ani": 3, "optimizer_cl": 3, "type": 3, "optim": [3, 4], "optimizer_default": 3, "base": [3, 4], "thi": [3, 4], "hold": 3, "all": [3, 4], "child": 3, "which": [3, 4], "ar": [3, 4], "automat": 3, "It": 3, "function": [3, 4], "an": 3, "interfac": 3, "lr": 3, "schedul": 3, "hf": 3, "trainer": 1, "tupl": 3, "list": [3, 4], "creat": [3, 4], "virtual": 3, "paramet": [3, 4], "group": 3, "arg": [3, 4], "kwarg": [3, 4], "perform": [3, 4], "singl": 3, "updat": 3, "closur": [], "callabl": [], "A": 3, "reevalu": [], "model": 3, "return": 3, "loss": 3, "option": [], "most": [], "unless": [], "otherwis": 3, "specifi": [], "should": [3, 4], "modifi": 3, "grad": [], "field": [], "reset": [], "gradient": 3, "torch": 3, "": 3, "set_to_non": [], "bool": 3, "instead": [3, 4], "set": 3, "zero": [], "none": [3, 4], "gener": 3, "have": 3, "lower": [], "memori": 3, "footprint": [], "can": 3, "modestli": [], "improv": [], "howev": 3, "chang": 3, "certain": [], "behavior": [], "For": 3, "exampl": 3, "1": 3, "when": 3, "user": [], "tri": [], "access": [], "manual": [], "op": [], "attribut": [], "full": [], "0": 3, "behav": [], "differ": [], "2": 3, "If": 3, "request": [], "true": 3, "follow": 3, "backward": [], "pass": [3, 4], "guarante": [], "did": [], "receiv": [], "3": 3, "i": 3, "one": [3, 4], "case": [], "doe": 3, "other": [3, 4], "skip": [], "altogeth": [], "associated_child_optim": 3, "us": 1, "commun": 3, "hyperparamet": 3, "between": 3, "mother": 3, "look": 3, "like": 3, "ordinari": 3, "dictionari": 3, "outsid": 3, "viewer": 3, "upon": 3, "its": 3, "member": 3, "notifi": 3, "object": 3, "provid": 3, "view": 3, "we": [3, 4], "sinc": [3, 4], "need": [3, 4], "travers": 3, "twice": 3, "auxiliari": 3, "hook": [3, 4], "onli": 3, "meant": 3, "conjunct": 3, "patch_model": 3, "param_group": 3, "from": 3, "argument": 3, "model_nam": 3, "dataset_nam": 3, "use_lora": 3, "use_quant": 3, "fp32": 3, "tf32": 3, "facebook": 3, "opt": 3, "125m": 3, "gair": 3, "lima": 1, "int": [3, 4], "1024": 3, "num_epoch": 3, "fals": 3, "gradient_checkpoint": 3, "fp16": 3, "profil": 1, "profiler_repeat_every_n_step": 3, "resume_from_checkpoint": 3, "output_dir": 3, "n_test_batch": 3, "10": 3, "given": 3, "dataset": 1, "The": 3, "name": 3, "train": 3, "meta": 3, "llama": 3, "7b": 3, "chat": 3, "etc": 3, "now": 3, "maximum": 3, "number": 3, "process": 3, "note": 3, "my": 3, "pc": 3, "handl": 3, "256": 3, "go": 3, "128": 3, "epoch": 3, "whether": 3, "lora": 3, "quantiz": 3, "float": 3, "data": 3, "do": 3, "detail": 3, "gpu": 3, "stack": 3, "dure": 3, "rudimentari": 3, "alwai": 3, "sampl": 3, "first": 3, "5": 3, "repeat": 3, "path": 3, "checkpoint": 3, "resum": 3, "entir": 3, "experi": 3, "simpli": 3, "proce": 3, "directori": 3, "where": 3, "output": 3, "store": 3, "run": [3, 4], "code": 3, "so": 3, "you": 3, "mai": 3, "also": 3, "want": 3, "small": 3, "batch": 3, "e": 3, "g": 3, "overfit": 3, "check": 3, "up": 3, "correctli": 3, "trainercallback": 3, "callback": 1, "respons": 3, "randomli": 3, "select": 3, "eval": 3, "templat": 3, "formatt": 3, "sequenc": 3, "length": 3, "log": 3, "state": 3, "control": 3, "keyword": 3, "ensur": 3, "ha": 3, "correct": 3, "format": 3, "trl": 3, "librari": 3, "To": 3, "compat": 3, "autotoken": 3, "from_pretrain": 3, "cache_dir": 3, "potenti": 3, "addit": 3, "special": 3, "load_dataset": 3, "plain_text": 3, "These": 3, "sfttrainer": 3, "train_dataset": 3, "datasetdict": 3, "transform": 3, "pretrainedtoken": 3, "instruct": 3, "map": 3, "method": 3, "datacollatorforcompletiononlylm": 3, "get": 3, "remov": 3, "prompt": 3, "complet": 3, "put": 3, "even": 3, "after": 3, "split": 3, "tokenized_prompt": 3, "usual": [], "eo": [], "end": 3, "don": [], "t": 3, "x": [3, 4], "input": 3, "same": [3, 4], "wai": 3, "both": 3, "string": 3, "tokenized_complet": 3, "take": [3, 4], "includ": 3, "without": 3, "logging_dir": 3, "profile_epoch": 3, "profile_n_step": 3, "trace": 3, "http": 3, "pytorch": 3, "org": 3, "memory_viz": 3, "drag": 3, "pickl": 3, "file": 3, "grow": 3, "upward": 3, "here": [3, 4], "might": 3, "issu": 3, "huggingfac": 1, "current": 3, "just": 3, "got": 3, "fork": 3, "parallel": 3, "alreadi": 3, "been": 3, "disabl": 3, "avoid": 3, "deadlock": 3, "warn": 3, "either": 3, "befor": 3, "possibl": 3, "explicitli": 3, "environ": 3, "variabl": 3, "tokenizers_parallel": 3, "m": 3, "sure": 3, "what": 3, "about": 3, "mayb": 3, "tend": 3, "out": 3, "doc": 3, "stabl": 3, "torch_cuda_memori": 3, "html": 3, "blog": 3, "understand": 3, "file_identifi": 3, "repeat_every_n_step": 3, "thei": [3, 4], "ident": 3, "make": 3, "sens": 3, "them": [3, 4], "subclass": [3, 4], "each": 3, "becom": 3, "too": 3, "larg": 3, "Be": 3, "veri": 3, "care": [3, 4], "infer": 3, "slow": 3, "open": 3, "see": 3, "co": 3, "main_class": 3, "trainingargu": 3, "trainerst": 3, "trainercontrol": 3, "event": 3, "call": [3, 4], "begin": 3, "accumul": 3, "sever": 3, "do_memory_profil": 3, "do_stack_profil": 3, "upload_to_wandb": 3, "save_fil": 3, "verbos": 3, "n": 3, "chrome": 3, "json": 3, "timelin": 3, "browser": 3, "w": 3, "b": 3, "how": 3, "hug": 1, "face": 1, "profilercallback": 3, "tutori": 3, "recip": [3, 4], "save": 3, "disk": 3, "safe": 3, "whenev": 3, "noth": 3, "written": 3, "mostli": 3, "github": 3, "copilot": 3, "file_path": 3, "devic": 3, "figsiz": 3, "20": 3, "12": 3, "titl": 3, "directli": 3, "sourc": 3, "com": 3, "blob": 3, "76f3663efea524adcb60f515b471c412aa78b95": 3, "py": 3, "l258": 3, "360761f7d039445e7b00493c2990ace9f94a5a9": 3, "_memory_profil": 3, "l1133": 3, "bit": 3, "hack": 3, "work": 3, "origin": 3, "svg": 3, "copyright": 3, "disclaim": 3, "c": 3, "2016": 3, "inc": 3, "adam": 3, "paszk": 3, "2014": 3, "soumith": 3, "chintala": 3, "2011": 3, "idiap": 3, "research": 3, "institut": 3, "ronan": 3, "collobert": 3, "2012": 3, "deepmind": 3, "technologi": 3, "korai": 3, "kavukcuoglu": 3, "nec": 3, "laboratori": 3, "america": 3, "2013": 3, "nyu": 3, "clement": 3, "farabet": 3, "2006": 3, "2010": 3, "leon": 3, "bottou": 3, "iain": 3, "melvin": 3, "jason": 3, "weston": 3, "sami": 3, "bengio": 3, "2001": 3, "2004": 3, "johnni": 3, "mariethoz": 3, "caffe2": 3, "present": 3, "right": 3, "reserv": 3, "contribut": 3, "googl": 3, "2015": 3, "yangq": 3, "jia": 3, "kakao": 3, "brain": 3, "2019": 3, "2020": 3, "cruis": 3, "llc": 3, "2022": 3, "caff": 3, "respect": 3, "contributor": 3, "similar": 3, "over": 3, "project": 3, "version": 3, "record": 3, "further": 3, "mark": 3, "specif": 3, "particular": 3, "indic": 3, "sole": 3, "commit": 3, "messag": 3, "redistribut": 3, "binari": 3, "form": 3, "modif": 3, "permit": 3, "condit": 3, "met": 3, "must": 3, "retain": 3, "abov": 3, "notic": 3, "reproduc": 3, "document": 3, "materi": 3, "distribut": 3, "neither": 3, "nor": 3, "endors": 3, "promot": 3, "product": 3, "deriv": 3, "softwar": 3, "prior": 3, "permiss": 3, "BY": 3, "THE": 3, "holder": 3, "AND": 3, "AS": 3, "express": 3, "OR": 3, "impli": 3, "warranti": 3, "BUT": 3, "NOT": 3, "limit": 3, "TO": 3, "OF": 3, "merchant": 3, "fit": 3, "FOR": 3, "purpos": 3, "IN": 3, "NO": 3, "shall": 3, "owner": 3, "BE": 3, "liabl": 3, "direct": 3, "indirect": 3, "incident": 3, "exemplari": 3, "consequenti": 3, "damag": 3, "procur": 3, "substitut": 3, "good": 3, "servic": 3, "profit": 3, "busi": 3, "interrupt": 3, "caus": 3, "ON": 3, "theori": 3, "liabil": 3, "contract": 3, "strict": 3, "tort": 3, "neglig": 3, "aris": 3, "IF": 3, "advis": 3, "SUCH": 3, "net_to_copi": 4, "defin": 4, "comput": 4, "everi": 4, "overridden": 4, "although": 4, "within": 4, "instanc": 4, "afterward": 4, "former": 4, "regist": 4, "while": 4, "latter": 4, "silent": 4, "ignor": 4, "net1": 4, "net2": 4, "optimzer1": 4, "optimizer2": 4, "shape_in": 4, "shape_out": 4, "lambda_net1": 4, "lambda_net2": 4, "net": 4, "In": 4, "copi": 4, "self": 4, "two": 4, "network": 4, "regardless": 4, "func": 4, "block": [], "python": [], "unzip": [], "zipped_list": [], "last": [], "implement": 1, "backpropag": 1, "trick": 1, "contain": 1, "utilitit": 1, "backprop": 3, "de": 3, "alloc": 3, "through": 3, "done": 3, "orchestr": 3, "usag": 3, "learn": 3, "rate": 3, "resourc": 3, "futur": 3, "refer": 3, "0f13e51efab6bea6b51200ea66396a0716d63182": 3, "sft_trainer": 3, "l55": 3, "_inner_training_loop": 3, "092f1fdaa4224fdd88c616dc9678e6fcb37bfffd": 3, "l1631": 3, "lambdalr": 3, "_modul": 3, "lr_schedul": 3, "lrschedul": 3, "ignit": 3, "handler": 3, "param_schedul": 3, "reducelronplateau": 3, "thing": 3, "turn": 3, "off": 3, "due": 3, "incompat": 3, "gradient_accumulation_step": 3, "mitig": 3, "clip": 3, "max_grad_norm": 3, "yet": 3, "taken": 3, "account": 3, "There": 3, "some": 1, "could": 3, "made": 3, "faster": 3, "nvidia": 3, "apex": 3, "But": 3, "ll": 3, "simpl": 3, "rabbithol": 3, "l1770c9": 3, "l1781c18": 3, "io": 3, "create_optimizer_and_schedul": 3, "haven": 3, "reason": 3, "later": 3, "fsdp": 3, "someth": 3, "mock": 3, "actual": 3, "time": 3}, "objects": {"": [[3, 0, 0, "-", "src"], [4, 0, 0, "-", "tests"]], "src": [[3, 0, 0, "-", "backprop_trick"], [3, 0, 0, "-", "finetune"], [3, 0, 0, "-", "lima_utils"], [3, 0, 0, "-", "profiler_callbacks"]], "src.backprop_trick": [[3, 1, 1, "", "MotherOptimizer"], [3, 1, 1, "", "VirtualParameterGroup"], [3, 3, 1, "", "cast_parameter_iterables_to_lists"], [3, 3, 1, "", "fusion_step_hook"], [3, 3, 1, "", "get_parameter_list"]], "src.backprop_trick.MotherOptimizer": [[3, 2, 1, "", "get_optimizers_and_virtual_param_groups"], [3, 2, 1, "", "step"], [3, 2, 1, "", "zero_grad"]], "src.backprop_trick.VirtualParameterGroup": [[3, 2, 1, "", "items"], [3, 2, 1, "", "join_parameters"], [3, 2, 1, "", "keys"], [3, 2, 1, "", "values"]], "src.finetune": [[3, 3, 1, "", "get_experiment_name"], [3, 3, 1, "", "main"]], "src.lima_utils": [[3, 1, 1, "", "ExampleCallback"], [3, 1, 1, "", "TemplateFormatter"], [3, 3, 1, "", "filter_example"], [3, 3, 1, "", "process_example"]], "src.lima_utils.ExampleCallback": [[3, 4, 1, "", "log_n_examples"], [3, 4, 1, "", "max_seq_length"], [3, 2, 1, "id0", "on_log"], [3, 4, 1, "", "template_formatter"]], "src.lima_utils.TemplateFormatter": [[3, 4, 1, "", "collator"], [3, 2, 1, "", "correct_tokenized_prompt"], [3, 4, 1, "", "data_processor"], [3, 4, 1, "", "ds"], [3, 2, 1, "id1", "get_instruction_and_response"], [3, 4, 1, "", "instruction_template"], [3, 4, 1, "", "map_kwargs"], [3, 2, 1, "id2", "process_lima"], [3, 2, 1, "id3", "remove_prompt_from_completion"], [3, 4, 1, "", "response_template"], [3, 4, 1, "", "test_ds"], [3, 4, 1, "", "tokenizer"], [3, 4, 1, "", "train_ds"]], "src.profiler_callbacks": [[3, 1, 1, "", "MemoryHistoryCallback"], [3, 1, 1, "", "ProfilerCallbackBase"], [3, 1, 1, "", "TorchProfilerCallback"], [3, 1, 1, "", "WandBProfilerCallback"], [3, 1, 1, "", "WandBTimerCallback"], [3, 3, 1, "", "extract_memory_timeline_svg"], [3, 3, 1, "", "get_timestamp"], [3, 3, 1, "", "torch_get_devices"]], "src.profiler_callbacks.MemoryHistoryCallback": [[3, 2, 1, "", "start"], [3, 2, 1, "", "stop"]], "src.profiler_callbacks.ProfilerCallbackBase": [[3, 2, 1, "", "on_epoch_begin"], [3, 2, 1, "", "on_epoch_end"], [3, 2, 1, "", "on_step_begin"], [3, 2, 1, "", "on_step_end"], [3, 2, 1, "", "on_train_end"], [3, 2, 1, "", "start"], [3, 2, 1, "", "start_"], [3, 2, 1, "", "step"], [3, 2, 1, "", "step_"], [3, 2, 1, "", "stop"], [3, 2, 1, "", "stop_"]], "src.profiler_callbacks.TorchProfilerCallback": [[3, 2, 1, "", "setup_profiler"], [3, 2, 1, "", "start"], [3, 2, 1, "", "step"], [3, 2, 1, "", "stop"]], "src.profiler_callbacks.WandBTimerCallback": [[3, 2, 1, "", "on_epoch_begin"], [3, 2, 1, "", "on_epoch_end"], [3, 2, 1, "", "on_step_begin"], [3, 2, 1, "", "on_step_end"], [3, 2, 1, "", "on_train_begin"], [3, 2, 1, "", "on_train_end"], [3, 2, 1, "", "setup"]], "tests": [[4, 0, 0, "-", "backprop_trick_test_utils"], [4, 0, 0, "-", "test_backprop_trick"], [4, 0, 0, "-", "test_lima_data_formatter"]], "tests.backprop_trick_test_utils": [[4, 1, 1, "", "ANN"], [4, 3, 1, "", "consistency_check"], [4, 3, 1, "", "net_eq"]], "tests.backprop_trick_test_utils.ANN": [[4, 2, 1, "", "forward"]], "tests.test_backprop_trick": [[4, 3, 1, "", "test_backprop_trick_small_ann_no_parameter_groups"], [4, 3, 1, "", "test_backprop_trick_small_ann_with_parameter_groups"], [4, 3, 1, "", "test_mother_optimizer"], [4, 3, 1, "", "test_mother_optimizer_init_no_parameter_groups_given"]], "tests.test_lima_data_formatter": [[4, 3, 1, "", "error_on_warning"], [4, 3, 1, "", "test_data_formatter_all_examples_no_warning"], [4, 3, 1, "", "test_data_formatter_exact_match"], [4, 3, 1, "", "test_error_on_warning"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:method", "3": "py:function", "4": "py:attribute"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "method", "Python method"], "3": ["py", "function", "Python function"], "4": ["py", "attribute", "Python attribute"]}, "titleterms": {"welcom": 0, "master": [0, 1], "": 0, "thesi": [0, 1], "document": 0, "indic": 0, "tabl": 0, "setup": 2, "modul": [2, 3, 4], "src": 3, "packag": [3, 4], "submodul": [3, 4], "backprop_trick": 3, "finetun": 3, "lima_util": 3, "profiler_callback": 3, "content": [0, 3, 4], "test": 4, "backprop_trick_test_util": 4, "test_backprop_trick": 4, "test_lima_data_formatt": 4, "implement": 3, "backpropag": 3, "trick": 3, "huggingfac": 3, "trainer": 3, "class": 3, "contain": 3, "utilitit": 3, "lima": 3, "dataset": 3, "some": 3, "us": 3, "callback": 3, "profil": 3, "hug": 3, "face": 3}, "envversion": {"sphinx.domains.c": 3, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 9, "sphinx.domains.index": 1, "sphinx.domains.javascript": 3, "sphinx.domains.math": 2, "sphinx.domains.python": 4, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 60}, "alltitles": {"Welcome to Master\u2019s thesis\u2019s documentation!": [[0, "welcome-to-master-s-thesis-s-documentation"]], "Contents:": [[0, null]], "Indices and tables": [[0, "indices-and-tables"]], "Masters-thesis": [[1, "masters-thesis"]], "setup module": [[2, "setup-module"]], "src package": [[3, "src-package"]], "Submodules": [[3, "submodules"], [4, "submodules"]], "src.backprop_trick module": [[3, "module-src.backprop_trick"]], "Implementation of the backpropagation trick for the HuggingFace Trainer class.": [[3, "implementation-of-the-backpropagation-trick-for-the-huggingface-trainer-class"]], "src.finetune module": [[3, "module-src.finetune"]], "src.lima_utils module": [[3, "module-src.lima_utils"]], "Contains the utilitites for the LIMA dataset.": [[3, "contains-the-utilitites-for-the-lima-dataset"]], "src.profiler_callbacks module": [[3, "module-src.profiler_callbacks"]], "Contains some useful callbacks for profiling in the Hugging Face Trainer.": [[3, "contains-some-useful-callbacks-for-profiling-in-the-hugging-face-trainer"]], "Module contents": [[3, "module-src"], [4, "module-tests"]], "tests package": [[4, "tests-package"]], "tests.backprop_trick_test_utils module": [[4, "module-tests.backprop_trick_test_utils"]], "tests.test_backprop_trick module": [[4, "module-tests.test_backprop_trick"]], "tests.test_lima_data_formatter module": [[4, "module-tests.test_lima_data_formatter"]]}, "indexentries": {"examplecallback (class in src.lima_utils)": [[3, "src.lima_utils.ExampleCallback"]], "memoryhistorycallback (class in src.profiler_callbacks)": [[3, "src.profiler_callbacks.MemoryHistoryCallback"]], "motheroptimizer (class in src.backprop_trick)": [[3, "src.backprop_trick.MotherOptimizer"]], "profilercallbackbase (class in src.profiler_callbacks)": [[3, "src.profiler_callbacks.ProfilerCallbackBase"]], "templateformatter (class in src.lima_utils)": [[3, "src.lima_utils.TemplateFormatter"]], "torchprofilercallback (class in src.profiler_callbacks)": [[3, "src.profiler_callbacks.TorchProfilerCallback"]], "virtualparametergroup (class in src.backprop_trick)": [[3, "src.backprop_trick.VirtualParameterGroup"]], "wandbprofilercallback (class in src.profiler_callbacks)": [[3, "src.profiler_callbacks.WandBProfilerCallback"]], "wandbtimercallback (class in src.profiler_callbacks)": [[3, "src.profiler_callbacks.WandBTimerCallback"]], "cast_parameter_iterables_to_lists() (in module src.backprop_trick)": [[3, "src.backprop_trick.cast_parameter_iterables_to_lists"]], "collator (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.collator"]], "correct_tokenized_prompt() (src.lima_utils.templateformatter method)": [[3, "src.lima_utils.TemplateFormatter.correct_tokenized_prompt"]], "data_processor (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.data_processor"]], "ds (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.ds"]], "extract_memory_timeline_svg() (in module src.profiler_callbacks)": [[3, "src.profiler_callbacks.extract_memory_timeline_svg"]], "filter_example() (in module src.lima_utils)": [[3, "src.lima_utils.filter_example"]], "fusion_step_hook() (in module src.backprop_trick)": [[3, "src.backprop_trick.fusion_step_hook"]], "get_experiment_name() (in module src.finetune)": [[3, "src.finetune.get_experiment_name"]], "get_instruction_and_response() (src.lima_utils.templateformatter method)": [[3, "id1"], [3, "src.lima_utils.TemplateFormatter.get_instruction_and_response"]], "get_optimizers_and_virtual_param_groups() (src.backprop_trick.motheroptimizer method)": [[3, "src.backprop_trick.MotherOptimizer.get_optimizers_and_virtual_param_groups"]], "get_parameter_list() (in module src.backprop_trick)": [[3, "src.backprop_trick.get_parameter_list"]], "get_timestamp() (in module src.profiler_callbacks)": [[3, "src.profiler_callbacks.get_timestamp"]], "instruction_template (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.instruction_template"]], "items() (src.backprop_trick.virtualparametergroup method)": [[3, "src.backprop_trick.VirtualParameterGroup.items"]], "join_parameters() (src.backprop_trick.virtualparametergroup method)": [[3, "src.backprop_trick.VirtualParameterGroup.join_parameters"]], "keys() (src.backprop_trick.virtualparametergroup method)": [[3, "src.backprop_trick.VirtualParameterGroup.keys"]], "log_n_examples (src.lima_utils.examplecallback attribute)": [[3, "src.lima_utils.ExampleCallback.log_n_examples"]], "main() (in module src.finetune)": [[3, "src.finetune.main"]], "map_kwargs (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.map_kwargs"]], "max_seq_length (src.lima_utils.examplecallback attribute)": [[3, "src.lima_utils.ExampleCallback.max_seq_length"]], "module": [[3, "module-src"], [3, "module-src.backprop_trick"], [3, "module-src.finetune"], [3, "module-src.lima_utils"], [3, "module-src.profiler_callbacks"], [4, "module-tests"], [4, "module-tests.backprop_trick_test_utils"], [4, "module-tests.test_backprop_trick"], [4, "module-tests.test_lima_data_formatter"]], "on_epoch_begin() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.on_epoch_begin"]], "on_epoch_begin() (src.profiler_callbacks.wandbtimercallback method)": [[3, "src.profiler_callbacks.WandBTimerCallback.on_epoch_begin"]], "on_epoch_end() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.on_epoch_end"]], "on_epoch_end() (src.profiler_callbacks.wandbtimercallback method)": [[3, "src.profiler_callbacks.WandBTimerCallback.on_epoch_end"]], "on_log() (src.lima_utils.examplecallback method)": [[3, "id0"], [3, "src.lima_utils.ExampleCallback.on_log"]], "on_step_begin() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.on_step_begin"]], "on_step_begin() (src.profiler_callbacks.wandbtimercallback method)": [[3, "src.profiler_callbacks.WandBTimerCallback.on_step_begin"]], "on_step_end() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.on_step_end"]], "on_step_end() (src.profiler_callbacks.wandbtimercallback method)": [[3, "src.profiler_callbacks.WandBTimerCallback.on_step_end"]], "on_train_begin() (src.profiler_callbacks.wandbtimercallback method)": [[3, "src.profiler_callbacks.WandBTimerCallback.on_train_begin"]], "on_train_end() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.on_train_end"]], "on_train_end() (src.profiler_callbacks.wandbtimercallback method)": [[3, "src.profiler_callbacks.WandBTimerCallback.on_train_end"]], "process_example() (in module src.lima_utils)": [[3, "src.lima_utils.process_example"]], "process_lima() (src.lima_utils.templateformatter method)": [[3, "id2"], [3, "src.lima_utils.TemplateFormatter.process_lima"]], "remove_prompt_from_completion() (src.lima_utils.templateformatter method)": [[3, "id3"], [3, "src.lima_utils.TemplateFormatter.remove_prompt_from_completion"]], "response_template (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.response_template"]], "setup() (src.profiler_callbacks.wandbtimercallback method)": [[3, "src.profiler_callbacks.WandBTimerCallback.setup"]], "setup_profiler() (src.profiler_callbacks.torchprofilercallback method)": [[3, "src.profiler_callbacks.TorchProfilerCallback.setup_profiler"]], "src": [[3, "module-src"]], "src.backprop_trick": [[3, "module-src.backprop_trick"]], "src.finetune": [[3, "module-src.finetune"]], "src.lima_utils": [[3, "module-src.lima_utils"]], "src.profiler_callbacks": [[3, "module-src.profiler_callbacks"]], "start() (src.profiler_callbacks.memoryhistorycallback method)": [[3, "src.profiler_callbacks.MemoryHistoryCallback.start"]], "start() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.start"]], "start() (src.profiler_callbacks.torchprofilercallback method)": [[3, "src.profiler_callbacks.TorchProfilerCallback.start"]], "start_() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.start_"]], "step() (src.backprop_trick.motheroptimizer method)": [[3, "src.backprop_trick.MotherOptimizer.step"]], "step() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.step"]], "step() (src.profiler_callbacks.torchprofilercallback method)": [[3, "src.profiler_callbacks.TorchProfilerCallback.step"]], "step_() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.step_"]], "stop() (src.profiler_callbacks.memoryhistorycallback method)": [[3, "src.profiler_callbacks.MemoryHistoryCallback.stop"]], "stop() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.stop"]], "stop() (src.profiler_callbacks.torchprofilercallback method)": [[3, "src.profiler_callbacks.TorchProfilerCallback.stop"]], "stop_() (src.profiler_callbacks.profilercallbackbase method)": [[3, "src.profiler_callbacks.ProfilerCallbackBase.stop_"]], "template_formatter (src.lima_utils.examplecallback attribute)": [[3, "src.lima_utils.ExampleCallback.template_formatter"]], "test_ds (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.test_ds"]], "tokenizer (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.tokenizer"]], "torch_get_devices() (in module src.profiler_callbacks)": [[3, "src.profiler_callbacks.torch_get_devices"]], "train_ds (src.lima_utils.templateformatter attribute)": [[3, "src.lima_utils.TemplateFormatter.train_ds"]], "values() (src.backprop_trick.virtualparametergroup method)": [[3, "src.backprop_trick.VirtualParameterGroup.values"]], "zero_grad() (src.backprop_trick.motheroptimizer method)": [[3, "src.backprop_trick.MotherOptimizer.zero_grad"]], "ann (class in tests.backprop_trick_test_utils)": [[4, "tests.backprop_trick_test_utils.ANN"]], "consistency_check() (in module tests.backprop_trick_test_utils)": [[4, "tests.backprop_trick_test_utils.consistency_check"]], "error_on_warning() (in module tests.test_lima_data_formatter)": [[4, "tests.test_lima_data_formatter.error_on_warning"]], "forward() (tests.backprop_trick_test_utils.ann method)": [[4, "tests.backprop_trick_test_utils.ANN.forward"]], "net_eq() (in module tests.backprop_trick_test_utils)": [[4, "tests.backprop_trick_test_utils.net_eq"]], "test_backprop_trick_small_ann_no_parameter_groups() (in module tests.test_backprop_trick)": [[4, "tests.test_backprop_trick.test_backprop_trick_small_ann_no_parameter_groups"]], "test_backprop_trick_small_ann_with_parameter_groups() (in module tests.test_backprop_trick)": [[4, "tests.test_backprop_trick.test_backprop_trick_small_ann_with_parameter_groups"]], "test_data_formatter_all_examples_no_warning() (in module tests.test_lima_data_formatter)": [[4, "tests.test_lima_data_formatter.test_data_formatter_all_examples_no_warning"]], "test_data_formatter_exact_match() (in module tests.test_lima_data_formatter)": [[4, "tests.test_lima_data_formatter.test_data_formatter_exact_match"]], "test_error_on_warning() (in module tests.test_lima_data_formatter)": [[4, "tests.test_lima_data_formatter.test_error_on_warning"]], "test_mother_optimizer() (in module tests.test_backprop_trick)": [[4, "tests.test_backprop_trick.test_mother_optimizer"]], "test_mother_optimizer_init_no_parameter_groups_given() (in module tests.test_backprop_trick)": [[4, "tests.test_backprop_trick.test_mother_optimizer_init_no_parameter_groups_given"]], "tests": [[4, "module-tests"]], "tests.backprop_trick_test_utils": [[4, "module-tests.backprop_trick_test_utils"]], "tests.test_backprop_trick": [[4, "module-tests.test_backprop_trick"]], "tests.test_lima_data_formatter": [[4, "module-tests.test_lima_data_formatter"]]}})